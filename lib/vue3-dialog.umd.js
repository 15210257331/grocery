(function(_,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(_=typeof globalThis<"u"?globalThis:_||self,e(_["vue3-dialog"]={},_.Vue))})(this,function(_,e){"use strict";var w;const I=typeof window<"u",k=t=>typeof t=="string",P=()=>{};I&&((w=window?.navigator)!=null&&w.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function b(t){return typeof t=="function"?t():e.unref(t)}function T(t){return t}function j(t){return e.getCurrentScope()?(e.onScopeDispose(t),!0):!1}function B(t){var o;const n=b(t);return(o=n?.$el)!=null?o:n}const E=I?window:void 0;function h(...t){let o,n,r,a;if(k(t[0])||Array.isArray(t[0])?([n,r,a]=t,o=E):[o,n,r,a]=t,!o)return P;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const l=[],u=()=>{l.forEach(i=>i()),l.length=0},p=(i,c,g,m)=>(i.addEventListener(c,g,m),()=>i.removeEventListener(c,g,m)),f=e.watch(()=>[B(o),b(a)],([i,c])=>{u(),i&&l.push(...n.flatMap(g=>r.map(m=>p(i,g,m,c))))},{immediate:!0,flush:"post"}),s=()=>{f(),u()};return j(s),s}const x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D="__vueuse_ssr_handlers__";x[D]=x[D]||{};function L(t={}){const{type:o="page",touch:n=!0,resetOnTouchEnds:r=!1,initialValue:a={x:0,y:0},window:l=E,eventFilter:u}=t,p=e.ref(a.x),f=e.ref(a.y),s=e.ref(null),i=d=>{o==="page"?(p.value=d.pageX,f.value=d.pageY):o==="client"?(p.value=d.clientX,f.value=d.clientY):o==="movement"&&(p.value=d.movementX,f.value=d.movementY),s.value="mouse"},c=()=>{p.value=a.x,f.value=a.y},g=d=>{if(d.touches.length>0){const y=d.touches[0];o==="page"?(p.value=y.pageX,f.value=y.pageY):o==="client"&&(p.value=y.clientX,f.value=y.clientY),s.value="touch"}},m=d=>u===void 0?i(d):u(()=>i(d),{}),v=d=>u===void 0?g(d):u(()=>g(d),{});return l&&(h(l,"mousemove",m,{passive:!0}),h(l,"dragover",m,{passive:!0}),n&&o!=="movement"&&(h(l,"touchstart",v,{passive:!0}),h(l,"touchmove",v,{passive:!0}),r&&h(l,"touchend",c,{passive:!0}))),{x:p,y:f,sourceType:s}}var N;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(N||(N={}));var V=Object.defineProperty,C=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,S=(t,o,n)=>o in t?V(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,Q=(t,o)=>{for(var n in o||(o={}))$.call(o,n)&&S(t,n,o[n]);if(C)for(var n of C(o))M.call(o,n)&&S(t,n,o[n]);return t};Q({linear:T},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const O=Symbol("DialogToken");function X(){const{x:t,y:o}=L(),{dialogs:n,createDialog:r,disposeDialog:a,getDialogId:l}=e.inject(O),u=e.computed(()=>n&&l?n[l()]:null);function p(s,i){return r(s,{...i,pointerX:t.value,pointerY:o.value}),u?.value?.promise}function f(s){s?u?.value?.resolve(s):u?.value?.reject("取消"),a()}return{open:p,close:f}}const Y=t=>(e.pushScopeId("data-v-98b78947"),t=t(),e.popScopeId(),t),A=["id"],H={class:"dialog-header"},R={class:"title"},W=[Y(()=>e.createElementVNode("svg",{t:"1679295681396",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3779",width:"26",height:"26"},[e.createElementVNode("path",{d:"M572.16 512l183.466667-183.04a42.666667 42.666667 0 1 0-60.586667-60.586667L512 451.84l-183.04-183.466667a42.666667 42.666667 0 0 0-60.586667 60.586667l183.466667 183.04-183.466667 183.04a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586667 0l183.04-183.466667 183.04 183.466667a42.666667 42.666667 0 0 0 60.586667 0 42.666667 42.666667 0 0 0 0-60.586667z","p-id":"3780"})],-1))],F={class:"dialog-body"},U=e.defineComponent({__name:"DialogContainer",props:{modalId:{type:String},title:{type:String,default:"dialog"},width:{type:Number,default:600},pointerX:{type:Number},pointerY:{type:Number}},setup(t){const o=t,{dialogs:n,createDialog:r,disposeDialog:a,getDialogId:l}=e.inject(O),u=e.computed(()=>{const c=(document.documentElement.clientWidth-o.width)/2,g=o.pointerX?o.pointerX-c+"px":"0px",m=o.pointerY?o.pointerY-100+"px":"0px";return{width:`${o.width}px`,marginLeft:`-${o.width/2}px`,transform:`scale(${f.value?"1":"0"})`,transformOrigin:`${g} ${m} 0px`}}),p=e.computed(()=>n[l()]),f=e.computed(()=>n[l()]?.visible);function s(c){c.target.className==="dialog-overlay"&&i()}function i(){p.value.reject("取消"),a()}return(c,g)=>(e.openBlock(),e.createElementBlock("div",{class:"dialog-overlay",id:t.modalId,style:e.normalizeStyle({opacity:e.unref(f)?"1":"0"}),onClick:s},[e.createElementVNode("div",{role:"dialog",tabindex:"-1",class:"dialog",style:e.normalizeStyle(e.unref(u))},[e.createElementVNode("div",H,[e.createElementVNode("p",R,e.toDisplayString(t.title),1),e.createElementVNode("i",{class:"close-icon",onClick:i},W)]),e.createElementVNode("div",F,[e.renderSlot(c.$slots,"default",{},void 0,!0)])],4)],12,A))}}),oe="",z=((t,o)=>{const n=t.__vccOpts||t;for(const[r,a]of o)n[r]=a;return n})(U,[["__scopeId","data-v-98b78947"]]);function G(){let t=0,o=null;const n=()=>`__modal__${t++}`,r=e.reactive({});function a(s,i){o&&clearTimeout(o);let c,g;const m=n(),v=new Promise((J,Z)=>{c=J,g=Z}),{props:d,...y}=i,q=p(s,y,d);r[m]={component:q,config:i,visible:!1,promise:v,reject:g,resolve:c},e.nextTick(()=>{r[m].visible=!0})}function l(){const s=u(),i=r[s];i&&(i.visible=!1,o=setTimeout(()=>{delete r[s]},300))}function u(){const s=Object.keys(r).filter(i=>!!r[i]);return s.length>0?s[0]:""}function p(s,i,c){return e.defineComponent({render(){return e.createVNode(z,i,{default:()=>[e.createVNode(s,c,null)]})}})}return e.provide(O,{dialogs:r,createDialog:a,disposeDialog:l,getDialogId:u}),{dialogList:e.computed(()=>Object.keys(r).filter(i=>!!r[i]).map(i=>({id:i,...r[i],component:e.toRaw(r[i].component)})))}}const K=e.defineComponent({__name:"DialogProvider",setup(t){const{dialogList:o}=G();return(n,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(n.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),a=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a.component),{key:a.id,id:a.id},null,8,["id"]))),128))],64))}});_.DialogProvider=K,_.useDialog=X,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})});
