(function(_,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(_=typeof globalThis<"u"?globalThis:_||self,e(_["vue3-dialog"]={},_.Vue))})(this,function(_,e){"use strict";var w;const I=typeof window<"u",k=t=>typeof t=="string",P=()=>{};I&&((w=window?.navigator)!=null&&w.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function b(t){return typeof t=="function"?t():e.unref(t)}function T(t){return t}function j(t){return e.getCurrentScope()?(e.onScopeDispose(t),!0):!1}function B(t){var n;const o=b(t);return(n=o?.$el)!=null?n:o}const E=I?window:void 0;function h(...t){let n,o,d,a;if(k(t[0])||Array.isArray(t[0])?([o,d,a]=t,n=E):[n,o,d,a]=t,!n)return P;Array.isArray(o)||(o=[o]),Array.isArray(d)||(d=[d]);const l=[],u=()=>{l.forEach(s=>s()),l.length=0},f=(s,p,g,m)=>(s.addEventListener(p,g,m),()=>s.removeEventListener(p,g,m)),r=e.watch(()=>[B(n),b(a)],([s,p])=>{u(),s&&l.push(...o.flatMap(g=>d.map(m=>f(s,g,m,p))))},{immediate:!0,flush:"post"}),i=()=>{r(),u()};return j(i),i}const x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D="__vueuse_ssr_handlers__";x[D]=x[D]||{};function L(t={}){const{type:n="page",touch:o=!0,resetOnTouchEnds:d=!1,initialValue:a={x:0,y:0},window:l=E,eventFilter:u}=t,f=e.ref(a.x),r=e.ref(a.y),i=e.ref(null),s=c=>{n==="page"?(f.value=c.pageX,r.value=c.pageY):n==="client"?(f.value=c.clientX,r.value=c.clientY):n==="movement"&&(f.value=c.movementX,r.value=c.movementY),i.value="mouse"},p=()=>{f.value=a.x,r.value=a.y},g=c=>{if(c.touches.length>0){const y=c.touches[0];n==="page"?(f.value=y.pageX,r.value=y.pageY):n==="client"&&(f.value=y.clientX,r.value=y.clientY),i.value="touch"}},m=c=>u===void 0?s(c):u(()=>s(c),{}),v=c=>u===void 0?g(c):u(()=>g(c),{});return l&&(h(l,"mousemove",m,{passive:!0}),h(l,"dragover",m,{passive:!0}),o&&n!=="movement"&&(h(l,"touchstart",v,{passive:!0}),h(l,"touchmove",v,{passive:!0}),d&&h(l,"touchend",p,{passive:!0}))),{x:f,y:r,sourceType:i}}var N;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(N||(N={}));var V=Object.defineProperty,C=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,S=(t,n,o)=>n in t?V(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,Q=(t,n)=>{for(var o in n||(n={}))$.call(n,o)&&S(t,o,n[o]);if(C)for(var o of C(n))M.call(n,o)&&S(t,o,n[o]);return t};Q({linear:T},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const O=Symbol("DialogToken");function X(){const{x:t,y:n}=L(),{dialogs:o,createDialog:d,disposeDialog:a,getDialogId:l}=e.inject(O),u=e.computed(()=>o&&l?o[l()]:null);function f(i,s){return d(i,{...s,pointerX:t.value,pointerY:n.value}),u?.value?.promise}function r(i){i?u?.value?.resolve(i):u?.value?.reject("取消"),a()}return{open:f,close:r}}const Y=t=>(e.pushScopeId("data-v-36b5147c"),t=t(),e.popScopeId(),t),A=["id"],H={class:"dialog-header"},R={class:"title"},W=[Y(()=>e.createElementVNode("svg",{t:"1679295681396",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3779",width:"26",height:"26"},[e.createElementVNode("path",{d:"M572.16 512l183.466667-183.04a42.666667 42.666667 0 1 0-60.586667-60.586667L512 451.84l-183.04-183.466667a42.666667 42.666667 0 0 0-60.586667 60.586667l183.466667 183.04-183.466667 183.04a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586667 0l183.04-183.466667 183.04 183.466667a42.666667 42.666667 0 0 0 60.586667 0 42.666667 42.666667 0 0 0 0-60.586667z","p-id":"3780"})],-1))],F={class:"dialog-body"},U=e.defineComponent({__name:"DialogContainer",props:{modalId:{type:String},title:{type:String,default:"dialog"},width:{type:Number,default:600},pointerX:{type:Number},pointerY:{type:Number}},setup(t){const n=t,{dialogs:o,createDialog:d,disposeDialog:a,getDialogId:l}=e.inject(O),u=e.computed(()=>{const p=(document.documentElement.clientWidth-n.width)/2,g=n.pointerX?n.pointerX-p+"px":"0px",m=n.pointerY?n.pointerY-100+"px":"0px";return{width:`${n.width}px`,marginLeft:`-${n.width/2}px`,transform:`scale(${r.value?"1":"0"})`,transformOrigin:`${g} ${m} 0px`}}),f=e.computed(()=>o[l()]),r=e.computed(()=>o[l()]?.visible);function i(p){p.target.className==="dialog-overlay"&&s()}function s(){f.value.reject("取消"),a()}return(p,g)=>(e.openBlock(),e.createElementBlock("div",{class:"dialog-overlay",id:t.modalId,style:e.normalizeStyle({opacity:e.unref(r)?"1":"0"}),onClick:i},[e.createElementVNode("div",{role:"dialog",tabindex:"-1",class:"dialog",style:e.normalizeStyle(e.unref(u))},[e.createElementVNode("div",H,[e.createElementVNode("p",R,e.toDisplayString(t.title),1),e.createElementVNode("i",{class:"close-icon",onClick:s},W)]),e.createElementVNode("div",F,[e.renderSlot(p.$slots,"default",{},void 0,!0)])],4)],12,A))}}),te="",z=((t,n)=>{const o=t.__vccOpts||t;for(const[d,a]of n)o[d]=a;return o})(U,[["__scopeId","data-v-36b5147c"]]);function G(){let t=0;const n=()=>`__modal__${t++}`,o=e.reactive({});function d(r,i){let s,p;const g=n(),m=new Promise((q,J)=>{s=q,p=J}),{props:v,...c}=i,y=u(r,c,v);o[g]={component:y,config:i,visible:!1,promise:m,reject:p,resolve:s},setTimeout(()=>{o[g].visible=!0},100)}function a(){const r=l(),i=o[r];i&&(i.visible=!1,setTimeout(()=>{delete o[r]},300))}function l(){const r=Object.keys(o).filter(i=>!!o[i]);return r.length>0?r[0]:""}function u(r,i,s){return e.defineComponent({render(){return e.createVNode(z,i,{default:()=>[e.createVNode(r,s,null)]})}})}return e.provide(O,{dialogs:o,createDialog:d,disposeDialog:a,getDialogId:l}),{dialogList:e.computed(()=>Object.keys(o).filter(i=>!!o[i]).map(i=>({id:i,...o[i],component:e.toRaw(o[i].component)})))}}const K=e.defineComponent({__name:"DialogProvider",setup(t){const{dialogList:n}=G();return(o,d)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(o.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),a=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a.component),{key:a.id}))),128))],64))}});_.DialogProvider=K,_.useDialog=X,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})});
